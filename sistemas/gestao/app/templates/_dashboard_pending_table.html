{% from '_pagination.html' import render_pagination with context %}

<div class="card full-width">
    <h2><i class="fa-solid fa-clock-rotate-left" style="margin-right: 8px; color: var(--action-primary);"></i> AOCS Pendentes</h2>
    <div class="table-wrapper">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Nº AOCS</th>
                    <th>Contrato</th>
                    <th>Data Emissão</th>
                    <th>Tempo de Espera</th>
                </tr>
            </thead>
            <tbody>
                {% if pedidos_pendentes %}
                    {% for item in pedidos_pendentes %}
                    <tr>
                        <td>
                            <strong>
                                <a href="{{ request.app.url_path_for('detalhe_pedido', numero_aocs=item.numero_aocs) }}">
                                    {{ item.numero_aocs }}
                                </a>
                            </strong>
                        </td>
                        <td>{{ item.numero_contrato }}</td>
                        
                        <td>{{ item.data_pedido.strftime('%d/%m/%Y') if item.data_pedido else 'N/D' }}</td> 
                        
                        {% set dias = item.dias_passados %}
                        {% set dias_class = '' %}
                        {% if dias > 60 %}
                            {% set dias_class = 'overdue-critical' %}
                        {% elif dias > 30 %}
                            {% set dias_class = 'overdue-warning' %}
                        {% elif dias > 7 %}
                            {% set dias_class = 'overdue-mild' %}
                        {% endif %}
                        
                        <td class="{{ dias_class }}">
                            <i class="fa-regular fa-calendar"></i> {{ dias }} dias
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="4">
                            <div class="empty-state mini">
                                <i class="fa-solid fa-check-circle" style="color: var(--action-success);"></i>
                                <p>Nenhuma pendência encontrada. Tudo em dia!</p>
                            </div>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>

    <div class="card-footer">
        {{ render_pagination(pagina_atual, total_paginas, 'home_ui') }}
    </div>
</div>